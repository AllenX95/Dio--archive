# 从GPU谈异构（4）

> **类型**: 文章
> **作者**: Dio-晶
> **赞同**: 319
> **评论**: 40
> **时间**: 1622351606
> **原文**: [https://zhuanlan.zhihu.com/p/376409878](https://zhuanlan.zhihu.com/p/376409878)

---

讲一个GPU及异构的重要逻辑：RISC-V

因为大家说法不一致，下文中的DSA泛指异构GPU的形态。

因为刚好RV的一个相当重要度的会议马上要开了，很棒，希望这一次峰会的召开能够再一次刷新大家对RISC-V的认知。我相信在IC行业里，RV一定能爆发出巨大的能量。

[RISC-V 2021 中国峰会议程公开](http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/jqHuVKee-L-bY3PsTo1rwg)

**我是RISC-V的死忠粉。**

是的，作为业界差不多TOP级别的ARM处理器架构师吧，我毫不掩饰自己的喜好，我是RISC-V的死忠粉。

一定有人觉得RISC-V和ARM之间是竞争关系，坊间也一直把RISC-V比做X86、ARM之后的第三个新起ISA，嗯，CPU的第三次革命，革命。

(ノ=Д=)ノ┻━┻ 掀桌子，掀桌子。

**这些理解是错的！**

曾经的我，也错误地理解RISC-V。Patterson大佬有一段时间到处宣讲关于DSA的黄金十年，摩尔定律停滞了，未来是DSA的天下。哔哔哔逼，这些都没错啦，鼓掌，但是patterson教授你为啥每次讲DSA讲着讲着就转到RISC-V ? 这个逻辑是怎么转折的? 是我英语太差吗？

![](./images/581fe649b687b8df79adf8cbb9ef5305.jpg)![](data:image/svg+xml;utf8,<svg%20xmlns='http://www.w3.org/2000/svg'%20width='410'%20height='273'></svg>)

我相信应该不止我一个人这么迷惑吧。讲DSA，和RISC-V是个什么关系啊? 很长一段时间，我把patterson大佬讲DSA带RISC-V的事认为是他夹带私货……

直到我慢慢学习慢慢理解，我才发现……

![](./images/c9a8142718b11adfbf7328b295cfada3.jpg)

所以讲结论吧：

**RISC-V并不是一个通用指令集。**

任何妄图用RISC-V构建一个高性能处理器的意图都是错误的，光是指令密度RISC-V就差了一大截。举个例子，如果要达成ARM 8x decode的同等性能，RISC-V需要10x decode甚至更宽，即使指令简单，但物理实现的难度是比指令复杂度更加难以跨越的。所以，不要妄图用RISC-V替代ARM或X86的通用处理器领域。最近20年，根本就没有新的第三个ISA诞生，甚至于某种角度，RISC-V不是一个ISA。

**RISC-V的基础指令可以用于IOT设备。**

确实，如果不考虑性能，只关注高能效地完成一些控制类任务，RISC-V简单小巧的特征有很好的发挥空间。

**1、RISC-V根本的实质是一个DSA扩展的平台。**

**这是patterson在DSA黄金十年中隐含的第一个谜底。**

这个才是RISC-V最核心的本质，所以我作为ARM架构师又是RISC-V死忠粉的原因，两者非但不冲突，反而是互补的。

我始终不明白为什么patterson教授不直白地说出这个答案，而要人自己去悟? 也许，大佬的心思你别猜吧。

为什么RISC-V是一个DSA的平台? 因为RV的最大特征是用**最小指令集合实现了图灵完备**，这代表着已经完成了一个最优美的background，你只需要在此之上涂上你想要的任意颜色就好了。有人攻击RISC-V指令容易分裂，错了，这反而是RISC-V最大的优势，因为它就是能让你任意地分裂啊，你无聊怎样分裂，最终的基本面都是图灵完备的，而图灵完备意味着什么？ 意味着你可以用C语言编程。

为什么DSA或者做GPU要图灵完备? 要支持C语言?

呵呵，这里可能会得罪到包括寒武纪、壁仞、沐熙等一切号称DSA的同学了。

随着认识的充分，我逐渐理解**patterson在DSA黄金十年中隐含的第二个谜底。**

**DSA包含：易于使用的通用型与极致能效的专用型两种。**

曾经有一个业界著名的疑问：为什么Google的TPU不外卖? 曾经有人说这是Google有意为之，为了自己把握算力巅峰。不能说错，但也不对。实际上我现在理解，TPU是云巨头基于私有的软硬件竞争力的极致定制化DSA，他的编程框架是私有的（绝对难用），它最终将以云服务而不是白盒硬件方式提供给用户。AWS的逻辑亦是如此。

而nvidia，它是一个通用的DSA，拥有着广泛使用的编程生态，也因此，它的硬件在计算能效上往往被专用DSA各种吊打（在国内是各种PPT吊打(ಡωಡ) ）。

事实上，长远来看，nvidia与TPU是两个正交的赛道。面对广泛的体量较小，更在乎开发效率的企业个人和小云厂商，先期选用Nvidia是更适合的。而但cloud长到一定体量，需要计算能效的极致化，并且能够以算力方式给用户提供服务时，一定会类似TPU一样定制DSA私用，通过支撑或SAAS间接面对客户。

所以无论是寒武纪、某某、某某，甚至某某，我认为在产品定位上是存在某些偏差的。要么通用博爱天下好好做个青楼红牌，要么专用就被某家cloud包养，相夫教子做一个强者的贤内助才是归宿。

结果，都是想当XX又立牌坊。

一个个通用型不够好，定制性不够佳。为了提升算力能效放弃通用编程能力，为了扩展应用范围又花钱开发大量基础算子来提升通用性。

当然，最大的问题是国内没有Google或AWS这样的富商能出的起包养的钱……次要问题是CUDA的生态又太过于强大，再建一个同样的非图灵完备的通用编程生态极度困难。

抄袭CUDA是不可取的，先不说法律问题，要模拟到一定相似度，基本上就是一个SIMT了，高能效的天花板也就是那样了。

世间安得双全法，不负如来不负卿?

![](./images/f6a667ea0644a766d38ea9cccd0e77c3.jpg)

答案就是patterson的DSA黄金十年的第二个谜底：**2、基于RISC-V扩展DSA，有可能同时兼顾通用和专用。**

怎样做到? 这里还会涉及到patterson的DSA黄金十年的第三个谜底。大佬就是大佬，早已安排了一切，就看你有没有明白。

**3、RISC-V配套了chisel编程语言和MLIR，在图灵完备性基础上，chisel可以快速基于用户特定算法（注意这里强调算法而不是电路）定制RISC-V扩展coprocessor（扩展指令集），同时，这部分算法抽象可以自己通过LLVM拓展的MLIR在compiler上描述出来。**

结果是，基于RISC-V的DSA，首先可以用C语言编程，然后，业界开放的OMP、DPC++、MPI等等通用编程方式都可以用于这个DSA异构编程，基于MLIR，用户原本已有的C或其他以C为基础的高层语言（例如Python），都可以在代码不做修改的情况下通过MLIR编译到RISC-V DSA上高效执行。

完美。

当然，有人会诟病目前RISC-V的扩展指令不能cover目前看到的很多业务领域，私有扩展能力可能有不足。

没有关系，时间会解决所有的问题。基于RISC-V的matrix ISA for DL在制定中，很快会出来的。基于RISC-V的rendering ISA也将要发布了，性能还不够好，时间会解决。此外，还有更多……更多……

<https://zhuanlan.zhihu.com/p/349060389>![](./images/cd6c99c09d59a5b6dbed38a2fdba9a6b.jpg)![](data:image/svg+xml;utf8,<svg%20xmlns='http://www.w3.org/2000/svg'%20width='349'%20height='129'></svg>)

所以，作为ARM架构师，我同时也是RISC-V的死忠粉。

假设我某一天创业，我会选择ARM来做general purpose CPU，选用RISC-V来做DSA（GPU），搭建完整的异构计算平台。

ARM购买ARM公司IP即可，而RISC-V，甚至都不需要购买，直接到业界抓开源版本（例如瑞士luca benini教授的）下载，选择最契合的版本，二次开发即可。

**ARM+RISC-V，双剑合璧，天下无敌。**

![](./images/457b771a34884c4546f391c460c56fa8.gif)![](data:image/svg+xml;utf8,<svg%20xmlns='http://www.w3.org/2000/svg'%20width='320'%20height='240'></svg>)

---

*由知乎爬虫生成于 2026-02-01 15:39:00*
